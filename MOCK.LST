SQL> SELECT ENAME,DNAME,LOC,SAL FROM EMP INNER JOIN DEPT
  2  ON EMP.DEPTNO=DEPT.DEPTNO
  3  WHERE
  4  TO_CHAR(HIREDATE,'FMDAY') IN ('SATURDAY','THURSDAY','WEDNESDAY') AND
  5  COMM > (SELECT MIN(COMM) FROM EMP) AND
  6  MGR IN (SELECT MGR FROM EMP WHERE ENAME='MARTIN') AND
  7  EMP.DEPTNO IN (SELECT DEPTNO FROM EMP GROUP BY DEPTNO HAVING COUNT(*)>2);

no rows selected

SQL> SELECT E.ENAME,M.ENAME,MM.ENAME,MM.SAL,MMD.LOC
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN DEPT MD
  5  ON M.DEPTNO=MD.DEPTNO
  6  JOIN EMP MM
  7  ON M.MGR=MM.EMPNO
  8  JOIN DEPT MMD
  9  ON MM.DEPTNO=MMD.DEPTNO
 10  WHERE
 11  E.SAL>(SELECT SAL FROM (SELECT RANK() OVER(ORDER BY SAL) AS RANK,SAL FROM
 12  (SELECT DISTINCT(SAL) FROM EMP)) WHERE RANK=2) AND
 13  E.SAL>(SELECT SAL FROM (SELECT RANK() OVER(ORDER BY SAL DESC) AS RANK,SAL FROM
 14  (SELECT DISTINCT(SAL) FROM EMP)) WHERE RANK=7) AND
 15  MD.DNAME IN ('ACCOUNTING','SALES') AND
 16  M.SAL<(SELECT SAL FROM EMP WHERE ENAME='KING') AND
 17  SUBSTR(MMD.LOC,2,1) IN ('A','E','I','O','U');

ENAME      ENAME      ENAME             SAL LOC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
---------- ---------- ---------- ---------- -------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
ALLEN      BLAKE      KING             5000 NEW YORK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

SQL> SELECT * FROM
  2  (SELECT ROW_NUMBER() OVER (ORDER BY EMPNO) AS SNO,EMP.*,TO_CHAR(HIREDATE,'FMDAY') AS DAY
  3  FROM EMP)
  4  WHERE SNO<=(SELECT COUNT(*)*0.7 FROM EMP);

       SNO      EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO DAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
---------- ---------- ---------- --------- ---------- --------- ---------- ---------- ---------- ---------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
         1       7369 SMITH      CLERK           7902 17-DEC-80        800                    20 WEDNESDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
         2       7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300         30 FRIDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
         3       7521 WARD       SALESMAN        7698 22-FEB-81       1250        500         30 SUNDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
         4       7566 JONES      MANAGER         7839 02-APR-81       2975                    20 THURSDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
         5       7654 MARTIN     SALESMAN        7698 28-SEP-81       1250       1400         30 MONDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
         6       7698 BLAKE      MANAGER         7839 01-MAY-81       2850                    30 FRIDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
         7       7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10 TUESDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
         8       7788 SCOTT      ANALYST         7566 19-APR-87       3000                    20 SUNDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
         9       7839 KING       PRESIDENT            17-NOV-81       5000                    10 TUESDAY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

9 rows selected.

SQL>  SELECT COUNT(*),LOC FROM EMP RIGHT JOIN DEPT
  2   ON EMP.DEPTNO(+)=DEPT.DEPTNO
  3   GROUP BY LOC;

  COUNT(*) LOC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
---------- -------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
         3 NEW YORK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
         6 CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
         1 BOSTON                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
         5 DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

SQL> SELECT EMPNO,ENAME,SAL,DNAME,LOC,
  2  TIME,EXP FROM
  3  (SELECT EMPNO,ENAME,SAL,DNAME,LOC,
  4  TO_CHAR(HIREDATE,'HH12:MM:SS') AS TIME,((SYSDATE-HIREDATE)/365) AS EXP,
  5  RANK() OVER(ORDER BY EMPNO) AS RANK FROM EMP INNER JOIN DEPT
  6  ON EMP.DEPTNO=DEPT.DEPTNO
  7  WHERE TO_CHAR(HIREDATE,'FMDAY') IN ('THURSDAY','FRIDAY') AND
  8  EMP.DEPTNO IN (10,20) AND
  9  SAL<(SELECT SAL FROM EMP WHERE ENAME='SCOTT'))
 10  WHERE RANK<3;

     EMPNO ENAME             SAL DNAME          LOC           TIME            EXP                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
---------- ---------- ---------- -------------- ------------- -------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
      7566 JONES            2975 RESEARCH       DALLAS        12:04:00 43.3469785                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

SQL> SPOOL OFF;
