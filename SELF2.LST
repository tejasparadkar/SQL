SQL> SELECT E.ENAME,E.JOB,M.ENAME,MD.DNAME
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN DEPT MD
  5  ON M.DEPTNO=MD.DEPTNO
  6  JOIN DEPT ED
  7  ON E.DEPTNO=ED.DEPTNO
  8  WHERE
  9  TO_CHAR(M.HIREDATE,'FMDAY') IN ('THURSDAY','SATURDAY')
 10  AND ED.DEPTNO IN (SELECT DEPTNO FROM DEPT WHERE
 11  DNAME IN ('SALES','RESEARCH'));

ENAME      JOB       ENAME      DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- --------- ---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
SMITH      CLERK     FORD       RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
SCOTT      ANALYST   JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
FORD       ANALYST   JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

SQL> SELECT E.ENAME,M.ENAME,MD.DNAME
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN DEPT MD
  5  ON M.DEPTNO=MD.DEPTNO
  6  JOIN DEPT ED
  7  ON E.DEPTNO=ED.DEPTNO
  8  WHERE
  9  E.SAL NOT BETWEEN 1100 AND 2200
 10  AND TO_CHAR(E.HIREDATE,'YY')>80
 11  AND ED.DEPTNO IN (SELECT DEPTNO FROM DEPT WHERE
 12  INSTR(LOC,'A',1)!=0 OR INSTR(LOC,'E',1)!=0);

ENAME      ENAME      DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
---------- ---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
JONES      KING       ACCOUNTING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
BLAKE      KING       ACCOUNTING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
CLARK      KING       ACCOUNTING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
SCOTT      JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
JAMES      BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
FORD       JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

6 rows selected.

SQL> SELECT E.ENAME,M.ENAME,MM.ENAME,E.JOB,M.JOB
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN EMP MM
  5  ON M.MGR=MM.EMPNO
  6  JOIN DEPT MMD
  7  ON MM.DEPTNO=MMD.DEPTNO
  8  WHERE
  9  TO_CHAR(E.HIREDATE,'MM') IN (12,01,09) AND
 10  E.SAL>1000 AND
 11  SUBSTR(MMD.LOC,1,1) IN ('A','N','R','D') AND
 12  SUBSTR(MMD.DNAME,1,1) IN ('A','N','R','D');

ENAME      ENAME      ENAME      JOB       JOB                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
---------- ---------- ---------- --------- ---------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MARTIN     BLAKE      KING       SALESMAN  MANAGER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
TURNER     BLAKE      KING       SALESMAN  MANAGER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
FORD       JONES      KING       ANALYST   MANAGER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
MILLER     CLARK      KING       CLERK     MANAGER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      

SQL> SELECT E.EMPNO,E.ENAME,M.EMPNO,M.ENAME
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN EMP MM
  5  ON M.MGR=MM.EMPNO
  6  JOIN DEPT MMD
  7  ON MM.DEPTNO=MMD.DEPTNO
  8  WHERE
  9  M.HIREDATE>E.HIREDATE AND
 10  MMD.DNAME IN ('ACCOUNTING','SALES') AND
 11  MMD.LOC!='BOSTON';

     EMPNO ENAME           EMPNO ENAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
---------- ---------- ---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
      7499 ALLEN            7698 BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
      7521 WARD             7698 BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

SQL> SELECT E.ENAME,TO_CHAR(E.HIREDATE,'FMDAY') AS DAY,M.ENAME,MM.ENAME,MM.HIREDATE
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN EMP MM
  5  ON M.MGR=MM.EMPNO
  6  WHERE
  7  E.JOB IN ('SALESMAN','CLERK','PRESIDENT') AND
  8  E.DEPTNO NOT IN (10,40) AND
  9  TO_CHAR(M.HIREDATE,'YY') NOT IN (80,88) AND
 10  MM.SAL>(SELECT SAL FROM EMP WHERE ENAME='SMITH');

ENAME      DAY       ENAME      ENAME      HIREDATE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
---------- --------- ---------- ---------- ---------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
SMITH      WEDNESDAY FORD       JONES      02-APR-81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
ALLEN      FRIDAY    BLAKE      KING       17-NOV-81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
WARD       SUNDAY    BLAKE      KING       17-NOV-81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MARTIN     MONDAY    BLAKE      KING       17-NOV-81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
TURNER     TUESDAY   BLAKE      KING       17-NOV-81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
ADAMS      SATURDAY  SCOTT      JONES      02-APR-81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
JAMES      THURSDAY  BLAKE      KING       17-NOV-81                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

7 rows selected.

SQL> SELECT E.ENAME,M.ENAME,MM.ENAME,E.SAL
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN EMP MM
  5  ON M.MGR=MM.EMPNO
  6  WHERE
  7  E.SAL=(SELECT SAL FROM
  8  (SELECT RANK() OVER(ORDER BY SAL DESC) AS RANK,SAL FROM
  9  (SELECT DISTINCT(SAL) FROM EMP)) WHERE RANK=3);

no rows selected

SQL> SELECT E.ENAME,M.ENAME,MMD.DNAME,MMD.LOC
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN EMP MM
  5  ON M.MGR=MM.EMPNO
  6  JOIN DEPT MMD
  7  ON MM.DEPTNO=MMD.DEPTNO
  8  WHERE
  9  E.COMM IS NOT NULL AND
 10  E.JOB IN ('SALESMAN','CLERK') AND
 11  M.HIREDATE<(SELECT HIREDATE FROM EMP WHERE ENAME='ADAMS') AND
 12  LENGTH(MMD.DNAME) BETWEEN 3 AND 9 AND
 13  LENGTH(MM.ENAME) BETWEEN 3 AND 9;

no rows selected

SQL> SELECT E.ENAME,M.ENAME,MD.DNAME
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN DEPT MD
  5  ON M.DEPTNO=MD.DEPTNO
  6  WHERE
  7  E.SAL IN (SELECT SAL FROM EMP GROUP BY SAL
  8  HAVING COUNT(*)>=2);

ENAME      ENAME      DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
---------- ---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MARTIN     BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
WARD       BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
FORD       JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
SCOTT      JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          

SQL> SELECT E.ENAME,MM.ENAME
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN EMP MM
  5  ON M.MGR=MM.EMPNO
  6  JOIN DEPT MMD
  7  ON MM.DEPTNO=MMD.DEPTNO
  8  WHERE
  9  LENGTH(E.COMM)=4 AND
 10  MOD(E.SAL,2)=0 AND
 11  MOD(E.SAL,3)=0 AND
 12  MOD(E.SAL,5)=0 AND
 13  MM.HIREDATE>ALL(SELECT HIREDATE FROM EMP WHERE JOB='SALESMAN') AND
 14  INSTR(MMD.DNAME,'Y',1)=0 AND
 15  INSTR(TO_CHAR(MM.HIREDATE,'FMADAY'),'Y',1)=0;

no rows selected

SQL> SELECT MAX(E.SAL),MIN(M.SAL)
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO;

MAX(E.SAL) MIN(M.SAL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
      3000       2450                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> SELECT COUNT(*)
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN EMP MM
  5  ON M.MGR=MM.EMPNO
  6  WHERE
  7  M.ENAME='BLAKE' AND
  8  MM.ENAME='KING';

  COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
         5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> SELECT SUM(E.SAL),SUM(M.SAL),SUM(MM.SAL)
  2  FROM EMP E JOIN EMP M
  3  ON E.MGR=M.EMPNO
  4  JOIN EMP MM
  5  ON M.MGR=MM.EMPNO
  6  JOIN EMP MMM
  7  ON MM.MGR=MMM.EMPNO
  8  JOIN DEPT MMMD
  9  ON MMM.DEPTNO=MMMD.DEPTNO
 10  WHERE
 11  MMMD.LOC IN ('NEW YORK','CHICAGO') AND
 12  MMM.DEPTNO IN (10,20,30)
 13  GROUP BY E.SAL
 14  HAVING SUM(E.SAL)>2500;

no rows selected

SQL> SPOOL OFF;
