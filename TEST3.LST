SQL> SELECT ENAME,DNAME FROM EMP,DEPT WHERE
  2  EMP.DEPTNO=DEPT.DEPTNO AND
  3  TO_CHAR(HIREDATE,'YY')=81 AND
  4  TO_CHAR(HIREDATE,'FMDAY') IN ('THURSDAY','FRIDAY','SUNDAY');

ENAME      DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
ALLEN      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
WARD       SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
JAMES      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
FORD       RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     

6 rows selected.

SQL> 
SQL> SELECT ENAME,JOB,DNAME FROM EMP,DEPT WHERE
  2  EMP.DEPTNO=DEPT.DEPTNO AND
  3  MGR IN (SELECT EMPNO FROM EMP
  4  WHERE ENAME IN ('KING','BLAKE') AND
  5  DEPTNO IN (20,30) AND
  6  DNAME IN ('SALES','ACCOUNTING'));

ENAME      JOB       DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- --------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
ALLEN      SALESMAN  SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
WARD       SALESMAN  SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
MARTIN     SALESMAN  SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
TURNER     SALESMAN  SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
JAMES      CLERK     SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> 
SQL> SELECT ENAME,DNAME FROM EMP,DEPT WHERE
  2  EMP.DEPTNO=DEPT.DEPTNO AND
  3  SAL IN (SELECT SAL FROM
  4  (SELECT RANK() OVER(ORDER BY SAL DESC) AS
  5  RANK,SAL FROM (SELECT DISTINCT(SAL) FROM EMP))
  6  WHERE RANK<5);

ENAME      DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
KING       ACCOUNTING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
FORD       RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
SCOTT      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

SQL> 
SQL> SELECT EMPNO,ENAME,TO_CHAR(HIREDATE,'FMDAY') DAY,DNAME
  2  FROM EMP,DEPT WHERE
  3  EMP.DEPTNO=DEPT.DEPTNO AND
  4  SAL IN (SELECT SAL FROM
  5  (SELECT RANK() OVER(ORDER BY SAL) AS
  6  RANK,SAL FROM (SELECT DISTINCT(SAL) FROM EMP));
RANK,SAL FROM (SELECT DISTINCT(SAL) FROM EMP))
                                             *
ERROR at line 6:
ORA-00907: missing right parenthesis 


SQL> 
SQL> SELECT ENAME,JOB,DNAME,LOC,((SAL*12)+((SAL*12)+12/100)) HIKE
  2  FROM EMP,DEPT WHERE
  3  EMP.DEPTNO=DEPT.DEPTNO AND
  4  LOC IN ('CHICAGO','DALLAS') AND
  5  MGR IN (SELECT MGR FROM EMP WHERE ENAME='BLAKE')
  6  
SQL> SELECT ENAME,DNAME,SAL
  2  FROM EMP,DEPT WHERE
  3  EMP.DEPTNO=DEPT.DEPTNO AND
  4  JOB IN ('MANAGER','CLERK','SALESMAN') AND
  5  (INSTR(DNAME,'A',1)=0 OR
  6  INSTR(DNAME,'E',1)=0 OR
  7  INSTR(DNAME,'I',1)=0 OR
  8  INSTR(DNAME,'O',1)=0 OR
  9  INSTR(DNAME,'U',1)=0) AND
 10  SAL>(SELECT SAL FROM
 11  (SELECT RANK() OVER(ORDER BY SAL) AS RANK,SAL FROM
 12  (SELECT DISTINCT(SAL) FROM EMP)) WHERE RANK=2);

ENAME      DNAME                 SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
---------- -------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
ALLEN      SALES                1600                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
WARD       SALES                1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
JONES      RESEARCH             2975                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MARTIN     SALES                1250                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
BLAKE      SALES                2850                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
CLARK      ACCOUNTING           2450                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
TURNER     SALES                1500                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
ADAMS      RESEARCH             1100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MILLER     ACCOUNTING           1300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

9 rows selected.

SQL> 
SQL> SELECT ENAME,DNAME,JOB,LOC
  2  FROM EMP,DEPT WHERE
  3  EMP.DEPTNO=DEPT.DEPTNO AND
  4  EMPNO IN (SELECT EMPNO FROM
  5  (SELECT RANK() OVER(ORDER BY EMPNO) AS RANK,EMPNO FROM
  6  EMP) WHERE RANK<3);

ENAME      DNAME          JOB       LOC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 
---------- -------------- --------- -------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
ALLEN      SALES          SALESMAN  CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
SMITH      RESEARCH       CLERK     DALLAS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> 
SQL> SELECT ENAME,DNAME,SAL
  2  FROM EMP,DEPT WHERE
  3  EMP.DEPTNO=DEPT.DEPTNO AND
  4  EMPNO IN (SELECT EMPNO FROM
  5  (SELECT RANK() OVER(ORDER BY EMPNO DESC) AS RANK,EMPNO FROM
  6  EMP) WHERE RANK<3);

ENAME      DNAME                 SAL                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
---------- -------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
FORD       RESEARCH             3000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MILLER     ACCOUNTING           1300                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

SQL> 
SQL> SELECT EMP.*,DNAME,LOWER(LOC)
  2  FROM EMP,DEPT WHERE
  3  EMP.DEPTNO=DEPT.DEPTNO AND
  4  TO_CHAR(HIREDATE,'YY') IN (81,82,87) AND
  5  LENGTH(ENAME)!=3 AND
  6  SAL BETWEEN 100 AND 999999999;

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO DNAME          LOWER(LOC)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
---------- ---------- --------- ---------- --------- ---------- ---------- ---------- -------------- -------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
      7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300         30 SALES          chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
      7521 WARD       SALESMAN        7698 22-FEB-81       1250        500         30 SALES          chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
      7566 JONES      MANAGER         7839 02-APR-81       2975                    20 RESEARCH       dallas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
      7654 MARTIN     SALESMAN        7698 28-SEP-81       1250       1400         30 SALES          chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
      7698 BLAKE      MANAGER         7839 01-MAY-81       2850                    30 SALES          chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
      7782 CLARK      MANAGER         7839 09-JUN-81       2450                    10 ACCOUNTING     new york                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
      7788 SCOTT      ANALYST         7566 19-APR-87       3000                    20 RESEARCH       dallas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
      7839 KING       PRESIDENT            17-NOV-81       5000                    10 ACCOUNTING     new york                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
      7844 TURNER     SALESMAN        7698 08-SEP-81       1500          0         30 SALES          chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
      7876 ADAMS      CLERK           7788 23-MAY-87       1100                    20 RESEARCH       dallas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
      7900 JAMES      CLERK           7698 03-DEC-81        950                    30 SALES          chicago                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
      7902 FORD       ANALYST         7566 03-DEC-81       3000                    20 RESEARCH       dallas                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
      7934 MILLER     CLERK           7782 23-JAN-82       1300                    10 ACCOUNTING     new york                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

13 rows selected.

SQL> 
SQL> SELECT DNAME,SAL,ENAME,DEPT.DEPTNO,LOC
  2  FROM EMP,DEPT WHERE
  3  EMP.DEPTNO=DEPT.DEPTNO AND
  4  DEPT.DEPTNO NOT IN (20,10) AND
  5  HIREDATE<(SELECT HIREDATE FROM
  6  (SELECT RANK() OVER (ORDER BY HIREDATE DESC) AS RANK,HIREDATE
  7  FROM EMP) WHERE RANK=1) AND
  8  SAL>(SELECT SAL FROM
  9  (SELECT RANK() OVER (ORDER BY SAL) AS RANK,SAL FROM
 10  (SELECT DISTINCT(SAL) FROM EMP)) WHERE RANK=3) AND
 11  MGR IN (SELECT EMPNO FROM EMP WHERE ENAME IN ('KING','FORD','SCOTT'))
 12  AND SUBSTR(ENAME,1,1) NOT IN ('Q','U','T') AND
 13  LENGTH(LOC)<8;

DNAME                 SAL ENAME          DEPTNO LOC                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
-------------- ---------- ---------- ---------- -------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
SALES                2850 BLAKE              30 CHICAGO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

SQL> 
SQL> SELECT DNAME,COUNT(*)
  2  FROM EMP,DEPT
  3  WHERE
  4  EMP.DEPTNO=DEPT.DEPTNO
  5  GROUP BY DNAME;

DNAME            COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
ACCOUNTING              3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
RESEARCH                5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
SALES                   6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

SQL> 
SQL> SELECT MAX(SAL),SUM(SAL),DNAME
  2  FROM EMP,DEPT
  3  WHERE
  4  EMP.DEPTNO=DEPT.DEPTNO AND
  5  LOC IN ('CHICAGO','DALLAS') AND
  6  (SAL*12)>(SELECT SAL*12 FROM EMP WHERE ENAME='SMITH') AND
  7  HIREDATE<(SELECT HIREDATE FROM EMP WHERE ENAME='MILLER')
  8  GROUP BY DNAME
  9  HAVING SUM(SAL)>ANY(SELECT SAL FROM EMP WHERE JOB='CLERK');

  MAX(SAL)   SUM(SAL) DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
---------- ---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
      3000       5975 RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
      2850       9400 SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             

SQL> SPOOL OFF;
